{% extends "index/base.html" %}
{% block head %}
  <link rel="stylesheet" href="{{ url_for('static', filename='css/article.css') }}"/>
{% endblock %}

{% block content %}
<div class="row">
{% if not news %}
  <div class="col-sm-offset-1 col-sm-10 text-center">
    <h1>无新闻</h1>
  </div>
{% endif %}
  <div class="col-sm-offset-1 col-sm-7">
    {% for one in news %}
      <div class="article-box">
        <div class="article-header">
          <h2 class="article-title">
            <a href="{{ url_for('main.news', url=one.url) }}">{{ one.title }}</a>
            {% if one.is_top %}
            <label class="text-red pull-right"><i class="fa fa-thumb-tack"></i></label>
            {% endif %}
          </h2>
          <div class="article-meta">
            <span><i class="fa fa-calendar"></i> {{ one.last_update_time.strftime('%Y-%m-%d') }}</span>
            <span><a href="{{ url_for('profile.index',username=one.user.username) }}">{{ one.user.name }}</a></span>
            {% if current_user.is_admin or (current_user.is_coach and current_user == one.user) %}
              <span><a href="{{ url_for('admin.edit_news', p=one.id) }}">edit</a></span>
            {% endif %}
          </div>
        </div>
        <div class="article-body">
          {{ one.md_shortcut|safe }}
        </div>
        <a href="{{ url_for('main.news',url=one.url) }}" class="article-more-link btn btn-primary btn-flat">阅读全文 >></a>
        <div class="article-footer">
          <i class="fa fa-tags"></i>
          {% for tag in one.tags %}
            <span><a href="{{ url_for('main.news_archive', tag=tag.name) }}" class="label label-default"> {{ tag.name }}</a></span>
          {% endfor %}
        </div>
      </div>
    {% endfor %}
    {% if news %}
    <nav>
      <ul class="pager">
        {% if page > 0 %}
        <li class="previous"><a href="{{ url_for('main.news_list', page = page - 1) }}"><span aria-hidden="true">&larr;</span> 上一页</a></li>
        {% endif %}
        {% if page * limit + limit < sum %}
          <li class="next"><a href="{{ url_for('main.news_list', page = page + 1) }}">下一页 <span aria-hidden="true">&rarr;</span></a></li>
        {% endif %}
      </ul>
    </nav>
    {% endif %}
  </div>
  <div class="col-sm-3">
  {% if recent_news != [] %}
    <div class="box box-default">
      <div class="box-header with-border">
        <h3 class="box-title">近期新闻</h3>
      </div>
      <div class="box-body no-padding">
        <ul class="recent_articles">
          {% for news in recent_news %}
            <li><i class="fa fa-link"></i> <a href="{{ url_for('main.news', url=news.url) }}">{{ news.title }}</a></li>
          {% endfor %}
        </ul>

      </div>
    </div>
  {% endif %}
  {% if tags != [] %}
   <div class="box box-default">
      <div class="box-header with-border">
        <h3 class="box-title"> 标签云</h3>
        <div class="box-tools pull-right">
          <a class="btn btn-link btn-sm" href="{{ url_for('main.news_archive') }}">新闻存档 >></a>
        </div>
      </div>
      <div class="box-body no-padding">
        <div class="tags_cloud">
          {% for tag in tags %}
            <a href="{{ url_for('main.news_archive', tag=tag.name) }}" class="tag">
              {{ tag.name }} <span>{{ tag.news.count() }}</span>
            </a>
          {% endfor %}
        </div>
      </div>
    </div>
  {% endif %}
  </div>
</div>
{% endblock %}

{% block script %}
<script type="text/javascript">
  function gaoTags() {
    var colors = [
      '#3c8dbc', '#357ca5', '#00c0ef', '#00a7d0',
      '#00a65a', '#008d4c', '#f39c12', '#db8b0b',
      '#dd4b39', '#d33724', '#39cccc', '#30bbbb',
      '#001f3f', '#001a35', '#605ca8', '#555299',
      '#ff851b', '#ff7701', '#d81b60', '#ca195a',
      '#111', '#000'
    ];
    $(".tags_cloud a").each(function(){
      var $tag = $(this);
      $tag.css('color', colors[parseInt(Math.random() * colors.length, 10)]);
      $tag.css('font-size', parseInt(Math.random() * 16  + 14) + 'px');
      var opacity = Math.random();
      if (opacity <= 0.5) opacity = opacity + 0.5;
      //$tag.css('opacity', opacity);
    });
  }
  $(document).ready(function(){
    gaoTags();
  });
</script>
{% endblock %}