{% extends "index/base.html" %}
{% block head %}
  <link rel="stylesheet" href="{{ url_for('static', filename='css/article.css') }}"/>
{% endblock %}

{% block content %}
<div class="row">
  <div class="col-sm-offset-1 col-sm-7">
    {% for one in news %}
      <div class="article-box">
        <div class="article-header">
          <h2 class="article-title">
            <a href="{{ url_for('main.news', url=one.url) }}">{{ one.title }}</a>
            {% if one.is_top %}
            <label class="text-red pull-right"><i class="fa fa-thumb-tack"></i></label>
            {% endif %}
          </h2>
          <div class="article-meta">
            <span><i class="fa fa-calendar"></i> {{ one.last_update_time.strftime('%Y-%m-%d') }}</span>
            <span><a href="{{ url_for('profile.index',username=one.user.username) }}">{{ one.user.name }}</a></span>
            {% if current_user == one.user %}
              <span><a href="{{ url_for('admin.edit_news', p=one.id) }}">edit</a></span>
            {% endif %}
          </div>
        </div>
        <div class="article-body text-muted">
          {{ one.md_shortcut|safe }}
        </div>
        <a href="{{ url_for('main.news',url=one.url) }}" class="article-more-link btn btn-primary btn-flat">阅读全文 >></a>
        <div class="article-footer">
          <i class="fa fa-tags"></i>
          {% for tag in one.tags %}
            <span><a href="{{ url_for('main.news_archive', tag=tag.name) }}" class="label label-default"> {{ tag.name }}</a></span>
          {% endfor %}
        </div>
      </div>
    {% endfor %}
  </div>
  <div class="col-sm-3">
  {% if recent_news != [] %}
    <div class="box box-primary">
      <div class="box-header">
        <h3 class="box-title">近期新闻</h3>
      </div>
      <div class="box-body no-padding">
        <ul class="recent_articles">
          {% for news in recent_news %}
            <li><a href="{{ url_for('main.news', url=news.url) }}">{{ news.title }}</a></li>
          {% endfor %}
        </ul>
      </div>
    </div>
  {% endif %}
  {% if tags != [] %}
   <div class="box box-primary">
      <div class="box-header">
        <h3 class="box-title">标签云</h3>
      </div>
      <div class="box-body no-padding">
        <div class="tags_cloud">
          {% for tag in tags %}
            <a href="{{ url_for('main.news_archive', tag=tag.name) }}" class="btn btn-sm">{{ tag.name }}</a>
          {% endfor %}
        </div>
      </div>
    </div>
  {% endif %}
  </div>
</div>
{% endblock %}

{% block script %}
  <script src="{{ url_for('static', filename='scripts/highlight.pack.js') }}"></script>
  <script type="text/javascript">
    hljs.initHighlightingOnLoad();
    $(document).ready(function(){
        var btn_color = ['btn-primary', 'btn-success', 'btn-info', 'btn-danger', 'btn-warning', 'bg-maroon',
        'bg-purple', 'bg-navy', 'bg-orange', 'bg-olive'];
        $(".tags_cloud a").each(function(){
            var $tag = $(this);
            $tag.addClass(btn_color[parseInt(Math.random()*btn_color.length)]);
            $tag.css('font-size',Math.random()*1.5+'em')

        })
    });
  </script>
{% endblock %}