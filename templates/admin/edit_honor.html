{% extends "admin/base.html" %}
{%- block head -%}
 <link rel="stylesheet" href="{{ url_for('static', filename='AdminLTE2/plugins/select2/select2.min.css') }}">
  <link rel="stylesheet" href="{{ url_for('static', filename='AdminLTE2/plugins/iCheck/square/blue.css') }}">

  <link rel="stylesheet" href="{{ url_for('static', filename='bootstrap-fileinput/css/fileinput.min.css') }}"/>
<link rel="stylesheet" href="{{ url_for('static', filename='bootstrap-tagsinput/bootstrap-tagsinput.css') }}"/>
  <link href="//cdn.bootcss.com/bootstrap-datetimepicker/4.15.35/css/bootstrap-datetimepicker.css" rel="stylesheet">
{%- endblock -%}
{% block content %}
<div class="box box-primary">
  <div class="box-header with-border">
      <h3 class="box-title"><i class="fa fa-book"></i> <span>修改荣誉</span></h3>
  </div>
  <form id="postForm" method="post" class="form-horizontal">
    <div class="box-body">
      {{ honor_form.hidden_tag() }}
      {{ honor_form.id(style="display:none") }}
      <div class="col-sm-8 col-md-9">
        <div class="form-group">
          <label class="control-label col-sm-2" for="inputTitle">标题</label>
          <div class="col-sm-9">
            {{ honor_form.title(class="form-control required",id="inputTitle", placeholder="标题") }}
          </div>
        </div>
        <div class="form-group">
          <label class="control-label col-sm-2" for="inputIntroduce">简介</label>
          <div class="col-sm-9">
            {{ honor_form.introduce(class='form-control required',id="inputIntroduce", rows="6", style="resize:none;" , placeholder="简介") }}
          </div>
        </div>
         <div class="form-group">
          <label class="control-label col-sm-2" for="inputContestName">比赛名称</label>
          <div class="col-sm-9">
            {{ honor_form.contest_name(class="form-control required",id="inputContestName", placeholder="比赛名称") }}
          </div>
        </div>
         <div class="form-group">
          <label class="control-label col-sm-2" for="inputTime">时间</label>
          <div class="col-sm-9">
            {{ honor_form.acquire_time(class="form-control date required",id="inputTime", placeholder="时间") }}
          </div>
        </div>
      <div class="form-group">
        <label class="control-label col-sm-2" for="inputContestLevel"><span class="required-star">* </span>等级</label>
        <div class="col-sm-9">
          {{ honor_form.contest_level(class='form-control required', id="inputContestLevel", placeholder="等级") }}
        </div>
      </div>
      <div class="form-group">
        <label class="control-label col-sm-2"><span class="required-star">* </span>类型</label>
        <div class="col-sm-9">
          {%- for sub in honor_form.type %}
            <label class="radio-inline">
              {{ sub }}
              {{ sub.label(style='margin-left:10px;') }}
            </label>
          {%- endfor %}
        </div>
        </div>
            <div class="form-group">
        <label class="control-label col-sm-2" for="inputUser">参赛用户</label>
        <div class="col-sm-9">
          {{ honor_form.users(class='form-control required', id="inputUser" ) }}
        </div>
      </div>
      {% if show_upload %}
          <div class="form-group">
          <label class="control-label col-sm-2" for="inputFile"><span class="required-star">* </span>选择文件</label>
          <div class="col-sm-9">
            {{ honor_form.upload(id="inputFile") }}
          </div>
        </div>
      {% endif %}
        <div class="form-group">
          <div class="control-label col-sm-2"></div>
          <div class="col-sm-9">
            {{ honor_form.submit(class='btn btn-primary', value='提交') }}
          </div>
        </div>
        <div class="alert alert-info col-sm-offset-2 col-sm-9" id="post-info" style="display: none;">
          <button type="button" class="close" data-dismiss="alert" aria-hidden="true">×</button>
          <span id="post-info-text"></span>
        </div>
      </div>
    </div>
  </form>
</div>
{% endblock %}
{%- block script -%}
<script src="{{ url_for('static', filename='AdminLTE2/plugins/iCheck/icheck.min.js') }}"></script>
<script src="{{ url_for('static', filename='AdminLTE2/plugins/select2/select2.min.js') }}"></script>
<script src="{{ url_for('static', filename='bootstrap-fileinput/js/fileinput.min.js') }}"></script>
<script src="{{ url_for('static', filename='bootstrap-tagsinput/bootstrap-tagsinput.min.js') }}"></script>
<script src="//cdn.bootcss.com/moment.js/2.10.6/moment.min.js"></script>
<script src="//cdn.bootcss.com/bootstrap-datetimepicker/4.15.35/js/bootstrap-datetimepicker.min.js"></script>
<script>

  function make_iCheck() {
    $('input[type="radio"], input[type="checkbox"]').iCheck({
      checkboxClass: 'icheckbox_square-blue',
      radioClass: 'iradio_square-blue',
       increaseArea: '20%' // optional
    });
  }
  function makeUserInput() {
    $('#inputUser').select2({
        tags: true,
        tokenSeparators: [',']
    });
  }
$(document).ready(function () {
    make_iCheck();
    makeUserInput();
    $('#inputTime').datetimepicker({format: 'YYYY/MM/DD'});
    $("#inputFile").fileinput({
      'showUpload': false,
      'allowedFileTypes': ['image'],
      'maxFileSize': 8192,
      'maxFileCount': 1
    });
  $("button.close").click(function () {
    $(".alert").slideUp();
    return false;
  });
  $('#postForm').submit(function() {
      var data = new FormData($('#postForm')[0]);
      $.ajax({
        url: "{{ url_for('ajax.modify_honor') }}",
        type: "POST",
        data: data,
        processData: false,  // 告诉jQuery不要去处理发送的数据
        contentType: false,   // 告诉jQuery不要去设置Content-Type请求头
        success:function (msg) {
          $("#post-info-text").html(msg);
          $("#post-info").hide().fadeIn(200);
        }
      });
      return false;
  });
});
</script>
{%- endblock -%}